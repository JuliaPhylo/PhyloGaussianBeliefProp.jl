<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Message schedules · PhyloGaussianBeliefProp.jl</title><meta name="title" content="Message schedules · PhyloGaussianBeliefProp.jl"/><meta property="og:title" content="Message schedules · PhyloGaussianBeliefProp.jl"/><meta property="twitter:title" content="Message schedules · PhyloGaussianBeliefProp.jl"/><meta name="description" content="Documentation for PhyloGaussianBeliefProp.jl."/><meta property="og:description" content="Documentation for PhyloGaussianBeliefProp.jl."/><meta property="twitter:description" content="Documentation for PhyloGaussianBeliefProp.jl."/><meta property="og:url" content="https://cecileane.github.io/PhyloGaussianBeliefProp.jl/stable/man/message_schedules/"/><meta property="twitter:url" content="https://cecileane.github.io/PhyloGaussianBeliefProp.jl/stable/man/message_schedules/"/><link rel="canonical" href="https://cecileane.github.io/PhyloGaussianBeliefProp.jl/stable/man/message_schedules/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyloGaussianBeliefProp.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><a class="tocitem" href="../evolutionary_models/">Evolutionary models</a></li><li><a class="tocitem" href="../clustergraphs/">Cluster graphs</a></li><li><a class="tocitem" href="../regularization/">Regularization</a></li><li class="is-active"><a class="tocitem" href>Message schedules</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Message schedules</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Message schedules</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cecileane/PhyloGaussianBeliefProp.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cecileane/PhyloGaussianBeliefProp.jl/blob/main/docs/src/man/message_schedules.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Message-schedules"><a class="docs-heading-anchor" href="#Message-schedules">Message schedules</a><a id="Message-schedules-1"></a><a class="docs-heading-anchor-permalink" href="#Message-schedules" title="Permalink"></a></h1><p>As described in <a href="../getting_started/#5.-Propose-a-schedule-from-the-cluster-graph">5. Propose a schedule from the cluster graph</a>, we build a message schedule by calling <a href="../../#PhyloGaussianBeliefProp.spanningtrees_clusterlist-Union{Tuple{T}, Tuple{MetaGraphsNext.MetaGraph{T, Graph} where Graph&lt;:Graphs.AbstractGraph{T}, Vector{PhyloNetworks.Node}}} where T"><code>spanningtrees_clusterlist</code></a> on our given cluster graph (output by <a href="../../#PhyloGaussianBeliefProp.clustergraph!-Tuple{PhyloNetworks.HybridNetwork, PhyloGaussianBeliefProp.AbstractClusterGraphMethod}"><code>clustergraph!</code></a>).</p><p>A schedule of messages can be visualized as a sequence of edge traversals (from sender to recipient) on the cluster graph.</p><p>Since the calibration of a cluster graph requires neighbor clusters to reach some state of agreement with each other, it is reasonable to expect that multiple messages may need to be sent back and forth on each edge. Thus, <em>proper</em> message schedules require that each edge is traversed in both directions, infinitely often (until stopping criteria are met).</p><p><code>spanningtrees_clusterlist</code> satisfies the requirements of a proper message schedule by specifying a finite sequence of edge traversals that together account for all possible messages on the cluster graph. This sequence can then be repeated as needed. Specifically:</p><ul><li>the sequence of edge traversals is returned as a collection of edge sets for different spanning trees of the cluster graph</li><li>each edge set is ordered as a preorder traversal of a spanning tree</li></ul><p>Each time <a href="../../#PhyloGaussianBeliefProp.calibrate!"><code>calibrate!</code></a> is called with a particular tree, it passes messages according to a postorder then preorder traversal of the tree.</p><p>Returning to the last few edges of the tree schedule from <a href="../getting_started/#5.-Propose-a-schedule-from-the-cluster-graph">5. Propose a schedule from the cluster graph</a>:</p><pre><code class="language-julia-repl hljs">julia&gt; DataFrame(parent=sched[1][1], child=sched[1][2])[13:end,:] # last 4 edges of tree 1 in preorder
4×2 DataFrame
 Row │ parent                             child                             
     │ Symbol                             Symbol                            
─────┼──────────────────────────────────────────────────────────────────────
   1 │ AncientNorthEurasianI1I2NonAfric…  EasternNorthAfricanAncientNorthE…
   2 │ EasternNorthAfricanAncientNorthE…  H1EasternNorthAfricanAncientNort…
   3 │ H1EasternNorthAfricanAncientNort…  OngeEasternNorthAfrican
   4 │ H1EasternNorthAfricanAncientNort…  KaritianaH1</code></pre><p>According to a postorder, the first message to be sent is from <code>KaritianaH1</code> to <code>H1EasternNorthAfricanAncientNort…</code>, followed by <code>OngeEasternNorthAfrican</code> to <code>H1EasternNorthAfricanAncientNort…</code> and so on.</p><p>An <em>iteration</em> of calibration refers to <code>calibrate!</code> being called once for each schedule tree in the collection.</p><p>Continuing with the code example from <a href="../regularization/#A-heuristic">A heuristic</a>, we:</p><ul><li>increase the number of iterations of calibration to 100 (the default is 1)</li><li>tell <code>calibrate!</code> to return once calibration is detected (<code>auto=true</code>)</li><li>log information on when calibration was detected (<code>info=true</code>)</li></ul><pre><code class="language-julia-repl hljs">julia&gt; PGBP.init_beliefs_assignfactors!(b, m, tbl_x, df.taxon, net.nodes_changed); # reset to initial beliefs

julia&gt; PGBP.regularizebeliefs_bynodesubtree!(fgb, fg); # regularize by node subtree

julia&gt; PGBP.calibrate!(fgb, sched, 100; auto=true, info=true)
[ Info: calibration reached: iteration 20, schedule tree 1
true</code></pre><p>Similarly, during iterative optimization (e.g <a href="../../#PhyloGaussianBeliefProp.calibrate_optimize_clustergraph!"><code>calibrate_optimize_clustergraph!</code></a>), multiple iterations of calibration are run for each set of candidate parameter values (till beliefs are calibrated) to determine the associated factored energy.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../regularization/">« Regularization</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Thursday 16 May 2024 14:04">Thursday 16 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
