<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Evolutionary models · PhyloGaussianBeliefProp.jl</title><meta name="title" content="Evolutionary models · PhyloGaussianBeliefProp.jl"/><meta property="og:title" content="Evolutionary models · PhyloGaussianBeliefProp.jl"/><meta property="twitter:title" content="Evolutionary models · PhyloGaussianBeliefProp.jl"/><meta name="description" content="Documentation for PhyloGaussianBeliefProp.jl."/><meta property="og:description" content="Documentation for PhyloGaussianBeliefProp.jl."/><meta property="twitter:description" content="Documentation for PhyloGaussianBeliefProp.jl."/><meta property="og:url" content="https://JuliaPhylo.github.io/PhyloGaussianBeliefProp.jl/stable/man/evolutionary_models/"/><meta property="twitter:url" content="https://JuliaPhylo.github.io/PhyloGaussianBeliefProp.jl/stable/man/evolutionary_models/"/><link rel="canonical" href="https://JuliaPhylo.github.io/PhyloGaussianBeliefProp.jl/stable/man/evolutionary_models/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyloGaussianBeliefProp.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../background/">Background</a></li><li class="is-active"><a class="tocitem" href>Evolutionary models</a><ul class="internal"><li><a class="tocitem" href="#Specifying-a-process"><span>Specifying a process</span></a></li><li><a class="tocitem" href="#Edge-factors"><span>Edge factors</span></a></li><li><a class="tocitem" href="#Hybrid-factors"><span>Hybrid factors</span></a></li></ul></li><li><a class="tocitem" href="../clustergraphs/">Cluster graphs</a></li><li><a class="tocitem" href="../regularization/">Regularization</a></li><li><a class="tocitem" href="../message_schedules/">Message schedules</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Evolutionary models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Evolutionary models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/PhyloGaussianBeliefProp.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/PhyloGaussianBeliefProp.jl/blob/main/docs/src/man/evolutionary_models.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Evolutionary-models"><a class="docs-heading-anchor" href="#Evolutionary-models">Evolutionary models</a><a id="Evolutionary-models-1"></a><a class="docs-heading-anchor-permalink" href="#Evolutionary-models" title="Permalink"></a></h1><h2 id="Specifying-a-process"><a class="docs-heading-anchor" href="#Specifying-a-process">Specifying a process</a><a id="Specifying-a-process-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-a-process" title="Permalink"></a></h2><p>Each trait evolutionary model is specified as a linear Gaussian process, such as a BM or some extension of it, that evolves along the phylogeny.</p><p>Minimally, the user provides a variance rate <span>$\Sigma$</span>, and a prior mean <span>$\mu$</span> and variance <span>$\bm{V}_{\!\!\rho}$</span> for the root state <span>$X_\rho$</span>. For example, <span>$\bm{V}_{\!\!\rho}=0$</span> treats <span>$X_\rho=\mu$</span> as known, while <span>$\bm{V}_{\!\!\rho}=\infty$</span> disregards all prior beliefs about <span>$X_\rho$</span>.</p><p>For example, the univariate BM can be specified as:</p><pre><code class="language-julia-repl hljs">julia&gt; PGBP.UnivariateBrownianMotion(1, 0) # root variance v = 0 (fixed root)
Univariate Brownian motion

- evolutionary variance rate σ2 :
1.0
- root mean μ :
0.0

julia&gt; PGBP.UnivariateBrownianMotion(1, 0, Inf) # root variance v = Inf (improper prior)
Univariate Brownian motion

- evolutionary variance rate σ2 :
1.0
- root mean μ :
0.0
- root variance v :
Inf</code></pre><p>The multivariate BM is available to model multivariate traits. If the components of a multivariate trait evolve in an uncorrelated manner, then <span>$\Sigma$</span> is a diagonal matrix and is specified its diagonal entries (e.g. <code>MvDiagBrownianMotion</code>). Otherwise, <span>$\Sigma$</span> is potentially dense and is passed in whole (e.g. <code>MvFullBrownianMotion</code>).</p><pre><code class="language-julia-repl hljs">julia&gt; PGBP.MvDiagBrownianMotion([1, 0.5], [-1, 1]) # v = [0, 0]
Multivariate Diagonal Brownian motion

- evolutionary variance rates (diagonal values in the rate matrix): R :
[1.0, 0.5]
- root mean μ :
[-1.0, 1.0]

julia&gt; PGBP.MvFullBrownianMotion([1 0.5; 0.5 1], [-1,1], [10^10 0; 0 10^10])
Multivariate Brownian motion

- evolutionary variance rate matrix: R :
[1.0 0.5; 0.5 1.0]
- root mean μ :
[-1.0, 1.0]
- root variance v :
[1.0e10 0.0; 0.0 1.0e10]</code></pre><p><span>$\Sigma$</span> can vary along the phylogeny. If path length <span>$t\ge 0$</span> from the root represents evolutionary time, then the Early Burst (EB) model and Accelerating Rate (AC) model respectively allow <span>$\Sigma$</span> to decay (<span>$b&lt;0$</span>) and grow (<span>$b&gt;0$</span>) along a <em>time-consistent</em> phylogeny:</p><p class="math-container">\[\Sigma(t) = \Sigma_0\exp(bt), \text{ where } \Sigma_0 = \Sigma(0)\]</p><p>This model is not implemented at the moment.</p><p>Selection can be additionally modeled by the <a href="https://en.wikipedia.org/wiki/Ornstein–Uhlenbeck_process">Ornstein-Uhlenbeck</a> (OU) process, which allows a trait to diffuse with variance rate <span>$\Sigma$</span> yet drift towards some optimal value <span>$\theta$</span>, with selection &quot;strength&quot; <span>$\bm{A}$</span>.</p><p>Below, we define a model with variance rate σ2=2 and selection strength α=3. This model has stationary variance γ2 = σ2/(2α) = 1/3:</p><pre><code class="language-julia-repl hljs">julia&gt; PGBP.UnivariateOrnsteinUhlenbeck(2, 3, -2, 0, 0.4) # σ2=2, α=3, θ=-2
homogeneous univariate Ornstein-Uhlenbeck

- stationary evolutionary variance γ2 :
0.3333333333333333
- selection strength α :
3.0
- optimal value θ :
-2.0
- root mean μ :
0.0
- root variance v :
0.4</code></pre><h2 id="Edge-factors"><a class="docs-heading-anchor" href="#Edge-factors">Edge factors</a><a id="Edge-factors-1"></a><a class="docs-heading-anchor-permalink" href="#Edge-factors" title="Permalink"></a></h2><p>After specifying the evolutionary model (e.g. <code>m = PGBP.UnivariateBrownianMotion(1, 0)</code>), it is eventually passed to <a href="../../#PhyloGaussianBeliefProp.assignfactors!-Union{Tuple{B}, Tuple{T}, Tuple{AbstractVector{B}, PhyloGaussianBeliefProp.EvolutionaryModel, NamedTuple{names, T} where {N, names, T&lt;:NTuple{N, AbstractVector}}, AbstractVector, Vector{PhyloNetworks.Node}, Any, Any, Any}} where {T, B&lt;:PhyloGaussianBeliefProp.AbstractBelief{T}}"><code>assignfactors!</code></a> (see <a href="../getting_started/#4.-Initialize-cluster-graph-beliefs">4. Initialize cluster graph beliefs</a>), which infers the conditional distribution for each node and assigns it to a cluster.</p><p>We refer to these conditional distributions as <em>edge factors</em> since they relate the states of a parent node and its child.</p><h2 id="Hybrid-factors"><a class="docs-heading-anchor" href="#Hybrid-factors">Hybrid factors</a><a id="Hybrid-factors-1"></a><a class="docs-heading-anchor-permalink" href="#Hybrid-factors" title="Permalink"></a></h2><p>Each reticulation node <span>$X_h$</span> has multiple parents <span>$X_{p_1},\dots,X_{p_k}$</span>, and is thus potentially associated with multiple edge factors. We reconcile these by modeling <span>$X_h$</span> as a weighted-average of its &quot;immediate parents&quot;, the child states for each of these edge factors.</p><p>Imagine that we introduce <span>$k$</span> copies <span>$X_{(p_1,h)},\dots,X_{(p_k,h)}$</span> of <span>$X_h$</span>, each of which descends from the corresponding <span>$X_{p_i}$</span>. Then <span>$X_h$</span> is modeled as a weighted-average of <span>$X_{(p_1,h)},\dots,X_{(p_k,h)}$</span>:</p><p class="math-container">\[X_h = \sum_{i=1}^k \gamma_{(p_i,h)} X_{(p_i,h)}\]</p><p>where the inheritance weights <span>$\gamma_{(p_i,h)}$</span> are positive and sum to 1.</p><p>Thus, each tree node is associated with an edge factor, and each hybrid node with a hybrid factor.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../background/">« Background</a><a class="docs-footer-nextpage" href="../clustergraphs/">Cluster graphs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 13 March 2025 02:06">Thursday 13 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
